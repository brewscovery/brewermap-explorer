-- Create missing checkins partition for July 2025 and future months
CREATE TABLE IF NOT EXISTS checkins_2025_07 PARTITION OF checkins 
FOR VALUES FROM ('2025-07-01') TO ('2025-08-01');

-- Enable RLS on the new partition
ALTER TABLE checkins_2025_07 ENABLE ROW LEVEL SECURITY;

-- Create partitions for August and beyond to prevent future issues
CREATE TABLE IF NOT EXISTS checkins_2025_08 PARTITION OF checkins 
FOR VALUES FROM ('2025-08-01') TO ('2025-09-01');

ALTER TABLE checkins_2025_08 ENABLE ROW LEVEL SECURITY;

CREATE TABLE IF NOT EXISTS checkins_2025_09 PARTITION OF checkins 
FOR VALUES FROM ('2025-09-01') TO ('2025-10-01');

ALTER TABLE checkins_2025_09 ENABLE ROW LEVEL SECURITY;

CREATE TABLE IF NOT EXISTS checkins_2025_10 PARTITION OF checkins 
FOR VALUES FROM ('2025-10-01') TO ('2025-11-01');

ALTER TABLE checkins_2025_10 ENABLE ROW LEVEL SECURITY;

CREATE TABLE IF NOT EXISTS checkins_2025_11 PARTITION OF checkins 
FOR VALUES FROM ('2025-11-01') TO ('2025-12-01');

ALTER TABLE checkins_2025_11 ENABLE ROW LEVEL SECURITY;

CREATE TABLE IF NOT EXISTS checkins_2025_12 PARTITION OF checkins 
FOR VALUES FROM ('2025-12-01') TO ('2026-01-01');

ALTER TABLE checkins_2025_12 ENABLE ROW LEVEL SECURITY;